{
    "contents" : "library(class)\n\ndata <- read.csv(file=\"breast-cancer-wisconsin.data\",head=TRUE,sep=\",\")\ndata <- data[!apply(data,1,function(x)any('?' %in% c(x))),]\ndataSize = nrow(data)\ndata <- data[sample(dataSize),]\ndata.orig <- data\n\ndata <- data.orig\ndata <- scale(data[,c(2:6, 8:10)])\n\nncol(data)\ncolnames(data) <- c(\"clump thickness\",\"cell size\",\"cell shape\",\n                    \"marginal adhesion\",\"Single Epithelial Cell Size\",\n                    \"Bland Chromatin\",\"Normal Nucleoli\",\"Mitoses\") #,\"class\")\ncolnames(data)\n\n# splitRate = 4\n# dataInEachPart = ceiling(nrow(data) / splitRate)\n\n\n# for ( x in 0:splitRate-1) {\n#   print ( x*dataInEachPart)  \ngetSuccessRatio <- function (splitRate, knn_k ) {\n#   x = 0\n  \n  print(splitRate-1)\n  \n  dataInEachPart = ceiling(nrow(data) / splitRate)\n  successRates = rep(NA, splitRate)\n  for ( x in 1:splitRate-1) {  \n    testSetIndexes = c((x*dataInEachPart):((x+1)*(dataInEachPart -1)))\n    trainingSet = data[-c(testSetIndexes),]\n    clasifier = factor(c(data.orig[-c(testSetIndexes),11]))\n    testSet = data[c(testSetIndexes),]\n    \n    data.knn <- knn(trainingSet, testSet, clasifier, k = knn_k, prob=TRUE)\n    data.knn  \n    data.knn.diff = data.orig[c(testSetIndexes),11]-(as.integer(data.knn[1:(dataInEachPart-1)])*2)\n    data.knn.diff.ok = length(which(data.knn.diff == 0))\n    data.knn.diff.ok = length(data.knn.diff[data.knn.diff == 0])\n    data.knn.diff.bad = length(which(data.knn.diff != 0))\n    print(x)\n    print(data.knn.diff.ok)\n    print(data.knn.diff.bad)\n    print(data.knn.diff.ok / (data.knn.diff.ok+data.knn.diff.bad))\n    successRates[x+1] <- data.knn.diff.ok / (data.knn.diff.ok+data.knn.diff.bad)\n  }\n\n  mean(successRates)\n  \n}\n\n\n\nsuccessRatios = getSuccessRatio(4,1)\n\n\nks <- 1:10\ntestSetProportions <- seq(4, 15, 1)\nrepetitions = 20\n\nsuccessRates <- outer( testSetProportions, ks, Vectorize(getSuccessRatio))\n# successRates <- successRatesSum / repetitions\n\nncols <- ncol(successRates)\nnrows <- nrow(successRates)\njet.colors <- colorRampPalette(c(\"red\", \"red\", \"yellow\"))\ncolorCount <- 100\ncolor <- jet.colors(colorCount)\nzfacet <- successRates[-1, -1] + successRates[-1, -ncols] + successRates[-nrows, -1] + successRates[-nrows, -ncols]\nfacetcol <- cut(zfacet, colorCount)\n\ndrawPlot <- function() {\n  persp(testSetProportions, ks , successRates, theta = -60, phi = 20, expand = 0.3, col = color[facetcol],\n        ticktype = \"detailed\",\n        xlab = \"k\", ylab = \"splitRatio\", zlab = \"effectiveness [%]\")\n}\ndrawPlot()\n",
    "created" : 1415454455711.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1018921722",
    "id" : "9F999C4",
    "lastKnownWriteTime" : 1415744237,
    "path" : "C:/home/aaaaStudia/Semestr_VII/MRO/Lab3/knn.R",
    "project_path" : "knn.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}